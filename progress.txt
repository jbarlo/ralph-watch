# Ralph Progress Log

## Ticket #1: Init Next.js project with pnpm
- Created Next.js 16 app with App Router, TypeScript, Tailwind, ESLint, pnpm
- Moved project contents from ralph-watch-ui/ subdirectory to workspace root
- Downgraded Tailwind from v4 to v3 due to native binding issues in NixOS environment
- Added tailwind.config.ts, updated postcss.config.mjs and globals.css for Tailwind v3
- Files added: package.json, tsconfig.json, next.config.ts, eslint.config.mjs, postcss.config.mjs, tailwind.config.ts, src/, public/
- Verified: `pnpm build` and `pnpm lint` pass

## Ticket #20: ESLint + Prettier + strict TS + quality check
- Installed prettier, eslint-config-prettier, eslint-plugin-prettier, lodash, @types/lodash
- Created .prettierrc with singleQuote, semi, tabWidth 2
- Updated eslint.config.mjs to extend prettier (flat config format)
- Created .prettierignore to exclude read-only files
- Enabled noUncheckedIndexedAccess in tsconfig.json
- Added scripts: format, lint (updated), typecheck, check
- Ran pnpm format to fix quote styles across codebase
- Files changed: package.json, tsconfig.json, eslint.config.mjs, .prettierrc, .prettierignore
- Verified: `pnpm check` passes (lint + typecheck)

## Ticket #21: Result type utilities for railway-oriented flow
- Created src/lib/result.ts with railway-oriented programming utilities
- Implemented Result<T, E> discriminated union (Ok/Err)
- Added constructor functions: ok(), err()
- Added type guards: isOk(), isErr()
- Added transformations: map(), flatMap(), mapErr()
- Added utilities: unwrapOr(), tryCatch(), tryCatchAsync()
- Files added: src/lib/result.ts
- Verified: `pnpm check` passes

## Ticket #22: Test setup with vitest
- Installed vitest, @testing-library/react, @testing-library/dom, jsdom, @vitejs/plugin-react
- Created vitest.config.ts with jsdom environment and react plugin
- Added scripts: `test` (vitest run), `test:watch` (vitest)
- Updated `check` script to include test: lint + typecheck + test
- Created src/lib/result.test.ts with 16 integration tests for Result utilities
- Files added: vitest.config.ts, src/lib/result.test.ts
- Verified: `pnpm check` passes (all 16 tests pass)

## Ticket #2: Add shadcn/ui and configure
- Initialized shadcn/ui with `pnpm dlx shadcn@latest init` (Neutral color theme)
- Added components: button, card, input, textarea, badge, scroll-area, toast (+ toaster)
- Created components.json config and src/lib/utils.ts (cn utility)
- Created src/hooks/use-toast.ts for toast functionality
- Fixed tailwind.config.ts to use ESM import for tailwindcss-animate
- Fixed eslint warning in use-toast.ts
- Ran pnpm format to fix prettier formatting issues
- Files added: components.json, src/lib/utils.ts, src/components/ui/*.tsx, src/hooks/use-toast.ts
- Files modified: tailwind.config.ts, src/app/globals.css, package.json
- Verified: `pnpm check` passes (lint + typecheck + tests)

## Ticket #3: Clean .gitignore
- Updated .env* pattern to be more specific (.env*.local only)
- Verified all required patterns covered: node_modules, .next, *.tsbuildinfo, .DS_Store
- Confirmed ralph files (tickets.json, progress.txt, CLAUDE.md) remain tracked
- Files changed: .gitignore
- Verified: `pnpm check` passes

## Ticket #4: Zod schemas for ralph files
- Installed zod v4.3.5
- Created src/lib/schemas.ts with loose Zod schemas using passthrough()
- TicketSchema: id (number), title (string), description (optional), status (default 'pending'), priority (optional)
- TicketsFileSchema: { tickets: Ticket[] } with passthrough for unknown fields
- Added CreateTicketSchema and UpdateTicketSchema for API operations
- Created src/lib/schemas.test.ts with 17 integration tests
- Files added: src/lib/schemas.ts, src/lib/schemas.test.ts
- Files modified: package.json
- Verified: `pnpm check` passes (all 33 tests pass)

## Ticket #5: Setup tRPC with file system access
- Installed @trpc/server, @trpc/client, @trpc/react-query, @tanstack/react-query, superjson
- Created src/server/trpc.ts with context (ralphDir from RALPH_DIR env var), superjson transformer
- Created src/server/routers/_app.ts as main router (empty, ready for sub-routers)
- Created src/app/api/trpc/[trpc]/route.ts as fetch handler for GET/POST
- Created src/lib/trpc.ts with createTRPCReact hook for client usage
- Created src/components/providers/TRPCProvider.tsx with React Query + tRPC clients
- Updated src/app/layout.tsx to wrap app with TRPCProvider
- Files added: src/server/trpc.ts, src/server/routers/_app.ts, src/app/api/trpc/[trpc]/route.ts, src/lib/trpc.ts, src/components/providers/TRPCProvider.tsx
- Files modified: src/app/layout.tsx, package.json
- Verified: `pnpm check` passes (all 33 tests pass)

## Ticket #6: tRPC procedures for tickets CRUD
- Created src/server/routers/tickets.ts with full CRUD operations
- list() - reads/parses tickets.json with Zod schema validation
- get(id) - returns single ticket by id, throws if not found
- create(title, description?, priority?) - adds ticket with auto-incremented id
- update(id, data) - partial update, preserves unknown fields
- delete(id) - removes ticket by id
- All operations use Result type for railway-oriented error handling
- Registered tickets router in src/server/routers/_app.ts
- Created src/server/routers/tickets.test.ts with 12 integration tests
- Files added: src/server/routers/tickets.ts, src/server/routers/tickets.test.ts
- Files modified: src/server/routers/_app.ts
- Verified: `pnpm check` passes (all 45 tests pass)

## Ticket #7: tRPC procedure for progress.txt
- Created src/server/routers/progress.ts with read() procedure
- read() returns progress.txt content as string, empty string if file missing
- Uses tryCatchAsync/isErr for railway-oriented error handling
- Registered progress router in src/server/routers/_app.ts
- Created src/server/routers/progress.test.ts with 4 integration tests
- Files added: src/server/routers/progress.ts, src/server/routers/progress.test.ts
- Files modified: src/server/routers/_app.ts
- Verified: `pnpm check` passes (all 49 tests pass)
